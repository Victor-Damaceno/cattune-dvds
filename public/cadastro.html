<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cattunes DVD's | Cadastro</title>
  <link rel="stylesheet" href="./css/cadastro.css">
  <script src="./js/sessao.js"></script>
  <link rel="icon" href="./assets/icon/VictorDVD_icon_64.ico">
</head>

<!-- onload="listarEstilos()" -->
<body onload="esconder()">
  <div class="corpo">
    <div class="header">
      <div class="container">
        <a href="index.html" class="img">
          <img src="./assets/icon/VictorDVD_logo.png" id="logo">
        </a>
      </div>
    </div>
    <div class="container">
      <div class="card-cadastro">
        <div class="formulario" id="forms"> <!-- form aqui-->
          
          <!-- Cadastro dados principais-->
          <div id="cadastro1">

            <div class="titulo">
              <h1>Cadastre-se</h1>
            </div>
  
            <div class="form">
              <span>Nome</span>
              <input class="entrada" id="nome_input" onkeyup="validarCampos()" placeholder="Seu nome aqui">
              <div class="validacao" id="campo1"> </div>
            </div>
  
            <div class="form">
              <span>Email</span>
              <input class="entrada"  id="email_input" onkeyup="validarCampos()" placeholder="E-mail">
              <div class="validacao" id="campo2"></div>
            </div>
  
            <div class="form">
              <span>Senha</span>
              <input class="entrada" id="senha_input" type="password" onkeyup="validarCampos()" placeholder="Senha">
              <div class="validacao" id="campo3"></div>
            </div>
            <div class="form">
              <span>Confirmar senha</span>
              <input class="entrada" id="confirmacao_senha_input" type="password" onkeyup='validarCampos()' placeholder="Confirme sua senha">
              <div class="validacao" id="campo4"></div>
            </div>
            <div class="form" id="estilo">
              <span>Estilo de música favorito: </span>
              <select id="estilo_input">
                <option value="#">Selecione um estilo</option>
                <option value="1">Pop</option>
                <option value="2">Rock</option>
                <option value="3">Hip-hop</option>
                <option value="4">Rap</option>
                <option value="5">Trap</option>
                <option value="6">KPOP</option>
                <option value="7">Samba</option>
                <option value="8">Funk</option>
                <option value="9">MPB</option>
                <option value="10">Pagode</option>
              </select>
            </div>
            <div class="botoes">
              <a class="button" href="index.html">Voltar</a>
              <a class="button" onclick="avancar1()">Avançar</a>
            </div>


          </div>

          
          <!-- Segundo Cadastro de preferências-->

          <div id="cadastro2">

            <div class="titulo">
            <h1>Cadastre-se</h1>
            </div>

          <div class="form">
            <span>Cantor ou banda favorita:</span>
            <input class="entrada" id="nome_musicos_input" placeholder="Insira sua banda ou cantor favorito">
          </div>


          <div class="form" id="estilo">
            <span>Selecione algum instrumento que você saiba tocar: </span>
            <select id="instrumento_input">
              <option value="#">Selecione um instrumento</option>
              <option value="1">Não sei tocar nenhum instrumento</option>              
              <option value="2">Violão</option>
              <option value="3">Violino</option>
              <option value="4">Guitarra</option>
              <option value="5">Baixo</option>
              <option value="6">Piano</option>
              <option value="6">Outros...</option>              
            </select>
          </div>

          <div class="form" id="estilo">
            <span>Selecione sua técnica vocal</span>
            <select id="tecnica_input">
              <option value="#">Selecione uma técnica vocal</option>
              <option value="1">Não conheço nenhuma técnica vocal</option>              
              <option value="2">Vibrato</option>
              <option value="3">Belting</option>
              <option value="4">Melisma</option>
              <option value="5">Outros...</option>              
            </select>
          </div>
          <div class="form" id="estilo">
            <span>Selecione seu nível em canto</span>
            <select id="nivel_input">
              <option value="#">Selecione seu nível de experiência em canto</option>
              <option value="1">Não tenho nenhuma experiência vocal</option>              
              <option value="2">Iniciante</option>
              <option value="3">Amador</option>
              <option value="4">Profissional</option>
            </select>
          </div>          


          <div class="form" id="estilo">
            <span>Selecione seu tipo de voz: </span>
            <select id="voz_input">
              <option value="#">Selecione uma classe vocal</option>
              <option value="1">Grave</option>
              <option value="2">Barítono</option>
              <option value="3">Tenor</option>
              <option value="4">Soprano</option>
              <option value="5">Contralto</option>
            </select>
          </div>

          <div class="botoes">
            <a class="button" onclick="voltar()">Voltar</a>          
            <a class="button" onclick="avancar2()">Cadastrar</a>

          </div>



        </div>
      </div>

    </div>
  </div>
</body>

</html>
<script>
// let listarEstilosCadastrados = [];
let erro = false;
let categoriaA = 0;
let categoriaB = 0;
let categoriaC = 0;
let categoriaD = 0;
let experienciaFinal = 0;
let nivelFinal = 0;

  var nomeVar = '';
  var emailVar = '';
  var senhaVar = '';
  var confirmacaoSenhaVar = '';
  var estiloVar = '';

  var nomeMusicoVar = '';
  var instrumentoVar = '';
  var tecnicaVar = '';
  var nivelVar = '';
  var vozVar = '';


  function voltar(){


    cadastro2.style.display = 'none';
    cadastro1.style.display = 'flex';
  }

  function esconder(){
          cadastro2.style.display = 'none';
  }

  function validarCampos(){
    if(
      nome_input.value.includes('1') ||
      nome_input.value.includes('2') ||
      nome_input.value.includes('3') ||
      nome_input.value.includes('4') ||
      nome_input.value.includes('5') ||
      nome_input.value.includes('6') ||
      nome_input.value.includes('7') ||
      nome_input.value.includes('8') ||
      nome_input.value.includes('9') ||
      nome_input.value.includes('0')
    ){
      campo1.innerHTML = 'Insira somente caractéres de "aA"-"zZ"';
      erro = true;
    }else{
      campo1.innerHTML ='';
      erro = false;
    }



    //Validação de email com laço de repetição For

      for(index = 0; index < email_input.value.length; index++){
        
        if(email_input.value.includes('@') == false){
          campo2.innerHTML ='Email inserido inválido';
        }
        else{
          campo2.innerHTML = '';
        }
      }

    if(senha_input.value == '' && confirmacao_senha_input != ''){
      if(senha_input.value != confirmacao_senha_input.value){
        campo3.innerHTML = 'As senhas inseridas nos campos são inválidas'
      }else{
        campo3.innerHTML = '';
      }

    }
    
    }

    function avancar1(){
      validarCampos()
      // aguardar();
      

      //Recupere o valor da nova input pelo nome do id
      // Agora vá para o método fetch logo abaixo
       nomeVar = nome_input.value;
       emailVar = email_input.value;
       senhaVar = senha_input.value;
       confirmacaoSenhaVar = confirmacao_senha_input.value;
       estiloVar = estilo_input.value;


      console.log(nomeVar)
  
      if(estiloVar == '1' || estiloVar == '6' ){
        categoriaA = categoriaA + 10;

      } else if(estiloVar == '2' || estiloVar == '9'){
        categoriaB = categoriaB + 10;

      } else if(estiloVar == '3' || estiloVar == '4' || estiloVar == '5'){
        categoriaC = categoriaC + 10;
      } else if(estiloVar == '7' || estiloVar == '8' || estiloVar == '10'){
        categoriaD = categoriaD + 10;
      }
      experienciaFinal = experienciaFinal + 10;

      // Verificando se há algum campo em branco
      if (
        nomeVar == "" ||
        emailVar == "" ||
        senhaVar == "" ||
        confirmacaoSenhaVar == "" ||
        estiloVar == "#" 
   
  
      ) {
        alert('Há campos do cadastro obrigatórios em branco!')
              cadastro1.style.display = 'flex';
        return false;
      }
  
      else if (senha_input.value != confirmacao_senha_input.value) {
        alert('Senha incorreta em Confirmar a senha!')
              cadastro1.style.display = 'flex';
      } else{
      cadastro1.style.display = 'none'
      cadastro2.style.display = 'flex';
      }



    }



  function avancar2() { 
    
    console.log(nomeVar)
       nomeMusicoVar = nome_musicos_input.value;
       instrumentoVar = instrumento_input.value;
       tecnicaVar = tecnica_input.value;
       nivelVar = nivel_input.value;
       vozVar = voz_input.value;

   if (
        nomeMusicoVar == "" ||
        instrumentoVar == "#" ||
        tecnicaVar == "#" ||
        nivelVar == '#' ||
        vozVar == "#"      
  
      ) {
        alert('Há campos do cadastro obrigatórios em branco!')
  

        return false;
      }
  
      if(instrumentoVar != '1'){
        experienciaFinal = experienciaFinal + 5;
      }
      if(tecnicaVar != '1'){
        experienciaFinal = experienciaFinal + 10
      }

      if(nivelVar == '1'){
        experienciaFinal = experienciaFinal - 5;
      }else if(nivelVar == '2'){
        experienciaFinal = experienciaFinal + 5;
      }else if(nivelVar == '3'){
        experienciaFinal = experienciaFinal + 10;
      }else if(nivelVar == '4'){
        experienciaFinal = experienciaFinal + 15;
      }


      cadastrar()
  }

  
  
  function cadastrar() {
    
    console.log(nomeMusicoVar);
        
        // Enviando o valor da nova input
        fetch("/usuarios/cadastrar", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            // crie um atributo que recebe o valor recuperado aqui
            // Agora vá para o arquivo routes/usuario.js
        nomeServer: nomeVar,
        emailServer: emailVar,
        senhaServer: senhaVar,
        estiloServer: estiloVar,
        nomeMusicoServer: nomeMusicoVar,
        instrumentoServer: instrumentoVar,
        tecnicaServer: tecnicaVar,
        nivelServer: nivelVar,
        vozServer: vozVar
      }),
    })
    .then(function (resposta) {
      console.log("resposta: ", resposta);
      
      if (resposta.ok) {
        alert("Preferências realizadas com sucesso!");
        alert("Cadastro realizado com sucesso! Redirecionando para tela de Login...");
        
        console.log(experienciaFinal);
        if(experienciaFinal < 10){
          nivelFinal = 'Iniciante';
        }else if(experienciaFinal < 25){
          nivelFinal = 'Amador';
        }else if(experienciaFinal < 40){
          nivelFinal = 'Experiente';
        }

        if(categoriaA == 10){

          if(nivelFinal == 'Iniciante'){
            
            forms.innerHTML =`
            <div class="titulo2">
              <h1>Sugestão!</h1>
              </div>
                    
              
              <div class='resultadoBox' style="background-image: url('assets/victor_sol.png'); background-repeat: no-repeat; width: 70%; height: 350px; background-size: cover;"> </div>

              <div class="link"> 
                <a href="https://youtu.be/YVJijQIualA?si=2rhm5teYragQVw2X">Clique aqui e aprenda uma nova música!</a>  
              </div>                            

              `;       

          }else if(nivelFinal == 'Amador'){

            forms.innerHTML =`
            <div class="titulo2">
              <h1>Sugestão!</h1>
              </div>
              


              <div class='resultadoBox' style="background-image: url('assets/shape_you.png'); background-repeat: no-repeat; width: 70%; height: 350px; background-size: cover;"> </div>

              <div class="link"> 
                <a href="https://youtu.be/JGwWNGJdvx8?si=Q0K-HX_duCOctpzR">Clique aqui e aprenda uma nova música!</a>  
              </div>              
              `;      

          }else if(nivelFinal == 'Experiente') {

            forms.innerHTML =`
            <div class="titulo2">
              <h1>Sugestão!</h1>
              </div>
              
       

              <div class='resultadoBox' style="background-image: url('assets/adelle_skyfall.png'); background-repeat: no-repeat; width: 70%; height: 350px; background-size: cover;"> </div>

              <div class="link"> 
                <a href="https://youtu.be/DeumyOzKqgI?si=vqH1tfC6XALAaFU7">Clique aqui e aprenda uma nova música!</a>  
              </div> 

              `;       

          }


        } else if(categoriaB == 10){

          if(nivelFinal == 'Iniciante'){

            forms.innerHTML =`
            <div class="titulo2">
              <h1>Sugestão!</h1>
              </div>
              
              <div class='resultadoBox' style="background-image: url('assets/legiao_urbana.png'); background-repeat: no-repeat; width: 70%; height: 350px; background-size: cover;"> </div>


              <div class="link"> 
                <a href="https://youtu.be/tI9kSZgMLsc?si=QxrvA0cYlaRYlmQ-">Clique aqui e aprenda uma nova música!</a>  
              </div> 
              `;       

          }else if(nivelFinal == 'Amador'){

            forms.innerHTML =`
            <div class="titulo2">
              <h1>Sugestão!</h1>
              </div>


              
              <div class='resultadoBox' style="background-image: url('assets/engenheiros_hawai.png'); background-repeat: no-repeat; width: 70%; height: 350px; background-size: cover;"> </div>

              <div class="link"> 
                <a href="https://youtu.be/YVJijQIualA?si=2rhm5teYragQVw2X">Clique aqui e aprenda uma nova música!</a>  
              </div> 
              `;               

          }else if(nivelFinal == 'Experiente') {

            forms.innerHTML =`
            <div class="titulo2">
              <h1>Sugestão!</h1>
              </div>
              

              <div class='resultadoBox' style="background-image: url('assets/queen.png'); background-repeat: no-repeat; width: 70%; height: 350px; background-size: cover;"> </div>


              <div class="link"> 
                <a href="https://youtu.be/YVJijQIualA?si=2rhm5teYragQVw2X">Clique aqui e aprenda uma nova música!</a>  
              </div> 
              `;     

          }
          

        } else if(categoriaC == 10){
          
            if(nivelFinal == 'Iniciante'){
              
            forms.innerHTML =`
            <div class="titulo2">
              <h1>Sugestão!</h1>
              </div>
              


              <div class='resultadoBox' style="background-image: url('assets/gangsta-paradise'); background-repeat: no-repeat; width: 70%; height: 350px; background-size: cover;"> </div>


              <div class="link"> 
                <a href="https://youtu.be/YVJijQIualA?si=2rhm5teYragQVw2X">Clique aqui e aprenda uma nova música!</a>  
              </div>               
              `;    

            }else if(nivelFinal == 'Amador'){

            forms.innerHTML =`
            <div class="titulo2">
              <h1>Sugestão!</h1>
              </div>
              



              <div class='resultadoBox' style="background-image: url('assets/racionais.png'); background-repeat: no-repeat; width: 70%; height: 350px; background-size: cover;"> </div>


              <div class="link"> 
                <a href="https://youtu.be/YVJijQIualA?si=2rhm5teYragQVw2X">Clique aqui e aprenda uma nova música!</a>  
              </div>               
              `;                     

            }else if(nivelFinal == 'Experiente') {

            forms.innerHTML =`
            <div class="titulo2">
              <h1>Sugestão!</h1>
              </div>
              
              <div>
                <h2>Teste</h2>
              </div>

              <div class='resultadoBox' style="background-image: url('assets/rap_god.png'); background-repeat: no-repeat; width: 70%; height: 350px; background-size: cover;"> </div>


              <div class="link"> 
                <a href="https://youtu.be/YVJijQIualA?si=2rhm5teYragQVw2X">Clique aqui e aprenda uma nova música!</a>  
              </div>               
              `;    

            }

        } else if(categoriaD == 10){

          if(nivelFinal == 'Iniciante'){

            forms.innerHTML =`
            <div class="titulo2">
              <h1>Sugestão!</h1>
              </div>
             

              
              <div class='resultadoBox' style="background-image: url('assets/legiao_urbana.png'); background-repeat: no-repeat; width: 70%; height: 350px; background-size: cover;"> </div>


              <div class="link"> 
                <a href="https://youtu.be/YVJijQIualA?si=2rhm5teYragQVw2X">Clique aqui e aprenda uma nova música!</a>  
              </div>               
              `;      
              
              
          }else if(nivelFinal == 'Amador'){

            forms.innerHTML =`
            <div class="titulo2">
              <h1>Sugestão!</h1>
              </div>
          

              <div class='resultadoBox' style="background-image: url('assets/tribalistas_infancia.png'); background-repeat: no-repeat; width: 70%; height: 350px; background-size: cover;"> </div>

              <div class="link"> 
                <a href="https://youtu.be/YVJijQIualA?si=2rhm5teYragQVw2X">Clique aqui e aprenda uma nova música!</a>  
              </div>               
              `;   

          }else if(nivelFinal == 'Experiente') {

            forms.innerHTML =`
            <div class="titulo2">
              <h1>Sugestão!</h1>
              </div>
              

              <div class='resultadoBox' style="background-image: url('assets/oceano.png'); background-repeat: no-repeat; width: 70%; height: 350px; background-size: cover;"> </div>

              <div class="link"> 
                <a href="https://youtu.be/YVJijQIualA?si=2rhm5teYragQVw2X">Clique aqui e aprenda uma nova música!</a>  
              </div>               
              `;     

          }
          
        }


             setTimeout(() => {
              console.log('AQUI2');
              window.location = "login.html";
              }, "6000");           
          
        }
      })
      .catch(function (resposta) {
        console.log(`#ERRO: ${resposta}`);
      });
      
      return false;
    }
    // function listarEstilos() {
  
    //     fetch("/estilos/listar", {
    //     method: "GET",
    //   })
    //     .then(function (resultado) {
    //       resposta.json().then((resultado) => {
    //         estilos.forEach((estilo) => {
    //           listarEstilosCadastrados.push(estilo);
  
    //           estilo.innerHTML += `
    //           <select id="estilo_input">
    //              <option value="${estilo.id}">
  
    //           </select>`   
              
              
             
    //           console.log("listarEstilosCadastrados")
    //           console.log(listarEstilosCadastrados)
    //         });
    //       });
    //     })
    //     .catch(function (resposta) {
    //       console.log(`#ERRO: ${resposta}`);
    //     });
    // }
    
  </script>